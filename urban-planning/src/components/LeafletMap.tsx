import React, { useEffect, useRef, RefObject, forwardRef, useImperativeHandle } from "react";
import L, { Layer, LayerGroup, Map, PathOptions } from "leaflet";
import "leaflet/dist/leaflet.css";
import { LeafletMapCreateLayers } from '../interfaces/LeafletLayerCreation';
import { GeoJSON, Feature } from 'geojson';

const LeafletMap = forwardRef<LeafletMapCreateLayers, {}>((props, ref) => {
  const mapElement: RefObject<HTMLDivElement> = useRef(null);
  const map = useRef<Map | null>(null);
  const layerGroup = useRef<LayerGroup>();

  // Callable functions from Parent component
  useImperativeHandle(ref, () => ({
    importGeoJSON(geoJSON: GeoJSON, style: (feature?: Feature) => PathOptions | PathOptions, onEachFeature: (feature: Feature, layer: Layer) => void): Layer {
        return createGeoJSONLayer(geoJSON, style, onEachFeature);
    }
  }));

  // Initializes Leaflet map with given tiles
  const initMap = (element: HTMLElement): Map => {
    const map: Map = L.map(element, {
      // options
    }).setView([48.858373738258386, 2.3518390365783475], 13);

    L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}", {
      maxZoom: 19,
      attribution: 'Map data Â© <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery (c) <a href="https://www.mapbox.com/">Mapbox</a>',
      id: 'mapbox/streets-v11',
      accessToken: process.env.REACT_APP_MAPBOX_ACCESS_TOKEN
    }).addTo(map);

    return map;
  };

  // Removes Leaflet map
  const removeMap = () => {
    if (map.current) {
      clearLayers();
      map.current.remove();
      map.current = null;
    }
  };

  // Creates a new layer
  const createLayer = (): LayerGroup => L.layerGroup();

  // Creates GeoJSON layer
  const createGeoJSONLayer = (geoJSON: GeoJSON, style: (feature?: Feature) => PathOptions | PathOptions, onEachFeature: (feature: Feature, layer: Layer) => void): Layer => {
    if (map.current && layerGroup.current) {
      console.log(geoJSON);
      const obj = {
        "type": "Feature",
        "geometry": {
            "coordinates": [
                [
                    [
                        2.2951669125644556,
                        48.873955232398906
                    ],
                    [
                        2.295039601294046,
                        48.873778669292605
                    ],
                    [
                        2.294933410026856,
                        48.87381228003837
                    ],
                    [
                        2.294547367192032,
                        48.87393450518294
                    ],
                    [
                        2.2940220935081865,
                        48.87410081129369
                    ],
                    [
                        2.2930044996279904,
                        48.87442293602357
                    ],
                    [
                        2.290487563932998,
                        48.875224020125785
                    ],
                    [
                        2.2899694820107936,
                        48.875388228592016
                    ],
                    [
                        2.2891984148902176,
                        48.87563248611323
                    ],
                    [
                        2.2880004850436135,
                        48.876017392807704
                    ],
                    [
                        2.2871948771838966,
                        48.87627614607661
                    ],
                    [
                        2.284286607417284,
                        48.877192856707495
                    ],
                    [
                        2.284073208977157,
                        48.877260117661145
                    ],
                    [
                        2.2839586600539112,
                        48.877296221895946
                    ],
                    [
                        2.283930296681111,
                        48.877305161665014
                    ],
                    [
                        2.283861680775442,
                        48.87732687589804
                    ],
                    [
                        2.2837988685555315,
                        48.87734675058714
                    ],
                    [
                        2.2837824571260055,
                        48.87735194502258
                    ],
                    [
                        2.283399423615623,
                        48.877475966111255
                    ],
                    [
                        2.2833514715521646,
                        48.87749149127028
                    ],
                    [
                        2.281315082204436,
                        48.87815828016081
                    ],
                    [
                        2.2798010731276523,
                        48.87865398575685
                    ],
                    [
                        2.279963953459513,
                        48.87870262247547
                    ],
                    [
                        2.2799900788713683,
                        48.878816510177884
                    ],
                    [
                        2.2799933621066897,
                        48.878830820440584
                    ],
                    [
                        2.279993452174722,
                        48.878831209497264
                    ],
                    [
                        2.2800135578227807,
                        48.87891885600273
                    ],
                    [
                        2.2801150773736416,
                        48.87936140216719
                    ],
                    [
                        2.280120642075384,
                        48.8793856611442
                    ],
                    [
                        2.280150321593033,
                        48.879515034253714
                    ],
                    [
                        2.2801534094213465,
                        48.87952849345148
                    ],
                    [
                        2.280190927620426,
                        48.879692037305034
                    ],
                    [
                        2.280241047173737,
                        48.879905069284135
                    ],
                    [
                        2.280260470013034,
                        48.87998762129246
                    ],
                    [
                        2.2803631177456682,
                        48.88042391957207
                    ],
                    [
                        2.280385638436292,
                        48.88051963667476
                    ],
                    [
                        2.280392399678889,
                        48.880550179289685
                    ],
                    [
                        2.280411635895815,
                        48.88063709459114
                    ],
                    [
                        2.280506511893323,
                        48.88106573016518
                    ],
                    [
                        2.2805305140971535,
                        48.88117417092934
                    ],
                    [
                        2.2805522831583214,
                        48.88127252117354
                    ],
                    [
                        2.28062626997943,
                        48.88160677126001
                    ],
                    [
                        2.2806597873723913,
                        48.881758190910176
                    ],
                    [
                        2.280696538064004,
                        48.88192422170795
                    ],
                    [
                        2.280701865919374,
                        48.88194829211298
                    ],
                    [
                        2.2808632035128307,
                        48.88267714355521
                    ],
                    [
                        2.2808889939000285,
                        48.882793656476565
                    ],
                    [
                        2.2809079174071663,
                        48.88287914328474
                    ],
                    [
                        2.2809949206471267,
                        48.882946728458386
                    ],
                    [
                        2.281050527715067,
                        48.88298992478158
                    ],
                    [
                        2.2811129468052034,
                        48.88303841320643
                    ],
                    [
                        2.281720744694919,
                        48.883510556093114
                    ],
                    [
                        2.2818567864837576,
                        48.883616234775275
                    ],
                    [
                        2.281957602597523,
                        48.883694546582305
                    ],
                    [
                        2.28206772042542,
                        48.883780083580774
                    ],
                    [
                        2.282260056749543,
                        48.88392948867925
                    ],
                    [
                        2.284140067562736,
                        48.88538978517346
                    ],
                    [
                        2.284342437010983,
                        48.88554696920705
                    ],
                    [
                        2.2844594764899067,
                        48.8856378737418
                    ],
                    [
                        2.284461918711419,
                        48.88563977154288
                    ],
                    [
                        2.2846472470028694,
                        48.88578371659912
                    ],
                    [
                        2.2853229656628478,
                        48.88630854076444
                    ],
                    [
                        2.2855471368578417,
                        48.88648264956846
                    ],
                    [
                        2.2856620566664128,
                        48.8865719033905
                    ],
                    [
                        2.288191574638624,
                        48.88781217362301
                    ],
                    [
                        2.288630004459926,
                        48.88802713303998
                    ],
                    [
                        2.288713552287365,
                        48.88806809481098
                    ],
                    [
                        2.2887255887142297,
                        48.88807399667943
                    ],
                    [
                        2.288797472782557,
                        48.88810923950061
                    ],
                    [
                        2.2890401233499404,
                        48.88822820608527
                    ],
                    [
                        2.2890408846792294,
                        48.88822858023109
                    ],
                    [
                        2.2915401424594437,
                        48.88945385809915
                    ],
                    [
                        2.2918716347701213,
                        48.88949295050775
                    ],
                    [
                        2.292408585153266,
                        48.88955627015784
                    ],
                    [
                        2.29266100118951,
                        48.88958603465168
                    ],
                    [
                        2.2929438579708004,
                        48.88961938862364
                    ],
                    [
                        2.2935105625151606,
                        48.889686211917514
                    ],
                    [
                        2.293674867458256,
                        48.889705584216706
                    ],
                    [
                        2.293965516779537,
                        48.889739854979474
                    ],
                    [
                        2.2942410265127693,
                        48.88977233876575
                    ],
                    [
                        2.294259439855608,
                        48.88977451035586
                    ],
                    [
                        2.2943377173820596,
                        48.889783739255066
                    ],
                    [
                        2.2945015123085484,
                        48.889803051650546
                    ],
                    [
                        2.29457793128438,
                        48.88981206169648
                    ],
                    [
                        2.2949329517932773,
                        48.88985391833462
                    ],
                    [
                        2.2950386202389694,
                        48.88986637656772
                    ],
                    [
                        2.2950461405555553,
                        48.88986726351424
                    ],
                    [
                        2.295059159172621,
                        48.88986879797142
                    ],
                    [
                        2.2950597011223377,
                        48.88986886051774
                    ],
                    [
                        2.2954821725952184,
                        48.890090520736905
                    ],
                    [
                        2.2958711688028552,
                        48.89029461381285
                    ],
                    [
                        2.2959511446265504,
                        48.89033657462474
                    ],
                    [
                        2.296001801795048,
                        48.890363151759516
                    ],
                    [
                        2.29637491293372,
                        48.89055890648217
                    ],
                    [
                        2.297190498751178,
                        48.89098679795558
                    ],
                    [
                        2.2974254669495964,
                        48.89111007089119
                    ],
                    [
                        2.297544533251598,
                        48.891172536197885
                    ],
                    [
                        2.2980290420550307,
                        48.89142671991997
                    ],
                    [
                        2.298029750346082,
                        48.89142709099797
                    ],
                    [
                        2.298030459988784,
                        48.891427462983216
                    ],
                    [
                        2.2980885731851175,
                        48.891457950914585
                    ],
                    [
                        2.298193843698148,
                        48.891513177827
                    ],
                    [
                        2.2982552060240455,
                        48.89154536825843
                    ],
                    [
                        2.2982925475587463,
                        48.89156495770961
                    ],
                    [
                        2.298355043513805,
                        48.891597744689776
                    ],
                    [
                        2.298395619142576,
                        48.89161903120325
                    ],
                    [
                        2.29846351611577,
                        48.89165465117575
                    ],
                    [
                        2.2985173827947825,
                        48.89168290975877
                    ],
                    [
                        2.2985719415628854,
                        48.89171153210167
                    ],
                    [
                        2.29863209211381,
                        48.891739858016585
                    ],
                    [
                        2.2986928119571366,
                        48.89176845073734
                    ],
                    [
                        2.298724645743156,
                        48.891783441904266
                    ],
                    [
                        2.2994176197197818,
                        48.89210976321442
                    ],
                    [
                        2.299685005150732,
                        48.89223567274878
                    ],
                    [
                        2.3000148492870864,
                        48.89239099235027
                    ],
                    [
                        2.300347579494416,
                        48.89254766786932
                    ],
                    [
                        2.300606101609291,
                        48.892669400970455
                    ],
                    [
                        2.301231387083187,
                        48.89296382611327
                    ],
                    [
                        2.3013246877722078,
                        48.89300775851729
                    ],
                    [
                        2.302262073087684,
                        48.893449127406996
                    ],
                    [
                        2.30226729931334,
                        48.89345158873621
                    ],
                    [
                        2.3023976530725867,
                        48.8935129645476
                    ],
                    [
                        2.3029519632330593,
                        48.8937739535337
                    ],
                    [
                        2.303279387506455,
                        48.893929721872084
                    ],
                    [
                        2.3036410973043173,
                        48.89410179917139
                    ],
                    [
                        2.303786854202772,
                        48.894171140173555
                    ],
                    [
                        2.3047528080914037,
                        48.894630663021076
                    ],
                    [
                        2.3056752764466513,
                        48.89506948402642
                    ],
                    [
                        2.3058180895211993,
                        48.89513741953693
                    ],
                    [
                        2.305903674552145,
                        48.89517813069968
                    ],
                    [
                        2.306453371684375,
                        48.89543961303654
                    ],
                    [
                        2.3071306319688665,
                        48.8957617689858
                    ],
                    [
                        2.307303439503621,
                        48.895843966795475
                    ],
                    [
                        2.307501404989391,
                        48.89593813233243
                    ],
                    [
                        2.3075352688792856,
                        48.89595090068917
                    ],
                    [
                        2.3075559045376735,
                        48.89595868044539
                    ],
                    [
                        2.3085947304191317,
                        48.89635035637044
                    ],
                    [
                        2.3088168038571846,
                        48.896434083709345
                    ],
                    [
                        2.309545501745653,
                        48.896708817846395
                    ],
                    [
                        2.3095496167888077,
                        48.89671036862095
                    ],
                    [
                        2.3096791115627844,
                        48.896759190222255
                    ],
                    [
                        2.3096800100425243,
                        48.896759528150696
                    ],
                    [
                        2.309853748651279,
                        48.89682502981044
                    ],
                    [
                        2.309954488790903,
                        48.89686301043744
                    ],
                    [
                        2.309955166057156,
                        48.89686326435147
                    ],
                    [
                        2.3108448564391604,
                        48.89719868147527
                    ],
                    [
                        2.311465263911617,
                        48.89743256993788
                    ],
                    [
                        2.3117717291577002,
                        48.89754810379589
                    ],
                    [
                        2.3118413735084125,
                        48.89757435860056
                    ],
                    [
                        2.3119265163518428,
                        48.89760645537046
                    ],
                    [
                        2.312274434228998,
                        48.89773761165883
                    ],
                    [
                        2.313083198059008,
                        48.8979834089565
                    ],
                    [
                        2.3133865352094665,
                        48.898075595852134
                    ],
                    [
                        2.313417843620672,
                        48.89808511119678
                    ],
                    [
                        2.3138185787956735,
                        48.89820689618851
                    ],
                    [
                        2.313868516284037,
                        48.8982220723541
                    ],
                    [
                        2.314140679308363,
                        48.898304782419906
                    ],
                    [
                        2.3149400837020706,
                        48.898547716462595
                    ],
                    [
                        2.3149565214264265,
                        48.89855271178465
                    ],
                    [
                        2.3161156587301894,
                        48.89890495062991
                    ],
                    [
                        2.3162874795635506,
                        48.89895716232212
                    ],
                    [
                        2.3165449798161704,
                        48.89903540882394
                    ],
                    [
                        2.3170623819876437,
                        48.899192629690525
                    ],
                    [
                        2.3172074422818403,
                        48.89923670687404
                    ],
                    [
                        2.317376401284589,
                        48.89928804720562
                    ],
                    [
                        2.3175375076685416,
                        48.89933700071936
                    ],
                    [
                        2.3178286218987902,
                        48.89942545707023
                    ],
                    [
                        2.3180476198910647,
                        48.89949199935812
                    ],
                    [
                        2.3185163897969168,
                        48.89963443357818
                    ],
                    [
                        2.318606749585794,
                        48.89968871530618
                    ],
                    [
                        2.3187164405659906,
                        48.899754607422466
                    ],
                    [
                        2.3187501111051976,
                        48.89977483398397
                    ],
                    [
                        2.3187800340336184,
                        48.89979280890792
                    ],
                    [
                        2.318780667438895,
                        48.89979318932544
                    ],
                    [
                        2.319112254490973,
                        48.89999237561181
                    ],
                    [
                        2.3198184328847216,
                        48.900416575128276
                    ],
                    [
                        2.319888833195916,
                        48.9004588624824
                    ],
                    [
                        2.3199113656332297,
                        48.900472398372145
                    ],
                    [
                        2.320231409443356,
                        48.90066464235005
                    ],
                    [
                        2.3203545824489598,
                        48.90073862952296
                    ],
                    [
                        2.3203874245799225,
                        48.900758357172116
                    ],
                    [
                        2.3210603339389446,
                        48.90078167266383
                    ],
                    [
                        2.321661147312236,
                        48.90080248604227
                    ],
                    [
                        2.32189285260998,
                        48.900810512452885
                    ],
                    [
                        2.323212970317498,
                        48.90085623105581
                    ],
                    [
                        2.3232459079139067,
                        48.90085737135165
                    ],
                    [
                        2.323262861419579,
                        48.90085795907366
                    ],
                    [
                        2.3232986364140316,
                        48.900859198124586
                    ],
                    [
                        2.3234775741559193,
                        48.900865393573326
                    ],
                    [
                        2.3237436656564405,
                        48.90087460617352
                    ],
                    [
                        2.3238744821576756,
                        48.900879134466386
                    ],
                    [
                        2.324347009076271,
                        48.90089549319508
                    ],
                    [
                        2.3243697396947662,
                        48.900896279724556
                    ],
                    [
                        2.3258710702783985,
                        48.90094824042839
                    ],
                    [
                        2.326183380699031,
                        48.90095904682564
                    ],
                    [
                        2.326184688283375,
                        48.90095909195344
                    ],
                    [
                        2.3263911691339363,
                        48.90096623569335
                    ],
                    [
                        2.3265877377190023,
                        48.90096996079672
                    ],
                    [
                        2.3266203070969986,
                        48.90097057738849
                    ],
                    [
                        2.327494109441389,
                        48.90098713048224
                    ],
                    [
                        2.3296296251864153,
                        48.90102755506178
                    ],
                    [
                        2.3296462058412155,
                        48.90102786909808
                    ],
                    [
                        2.329652715098317,
                        48.90102799186513
                    ],
                    [
                        2.3301468523870086,
                        48.90103733954291
                    ],
                    [
                        2.330149980858341,
                        48.901037399307995
                    ],
                    [
                        2.3300918056929296,
                        48.90086497431875
                    ],
                    [
                        2.3299705658647927,
                        48.900505636688415
                    ],
                    [
                        2.3299365265344125,
                        48.90040474607647
                    ],
                    [
                        2.3299032497608723,
                        48.9003060882204
                    ],
                    [
                        2.329460411339438,
                        48.898993539620854
                    ],
                    [
                        2.329092029203872,
                        48.89793618030298
                    ],
                    [
                        2.329055617357842,
                        48.897831674118265
                    ],
                    [
                        2.3290097629600504,
                        48.89770004817865
                    ],
                    [
                        2.328984742459738,
                        48.897628227701325
                    ],
                    [
                        2.3289769716939426,
                        48.897605052754066
                    ],
                    [
                        2.3282909957424396,
                        48.89555932176257
                    ],
                    [
                        2.327443402247341,
                        48.89305503811954
                    ],
                    [
                        2.327284587717891,
                        48.89258048827977
                    ],
                    [
                        2.3268730620405482,
                        48.891350772796535
                    ],
                    [
                        2.3266160891247902,
                        48.89058285886171
                    ],
                    [
                        2.3262815201307037,
                        48.88960575642487
                    ],
                    [
                        2.3259142140908415,
                        48.88853299519872
                    ],
                    [
                        2.325754138720076,
                        48.88802146004379
                    ],
                    [
                        2.3256792251429186,
                        48.887782067788685
                    ],
                    [
                        2.3256165133805236,
                        48.88758165899794
                    ],
                    [
                        2.3255901614406964,
                        48.887497444942674
                    ],
                    [
                        2.326357445937338,
                        48.885831161373716
                    ],
                    [
                        2.3267836230308396,
                        48.88491312904507
                    ],
                    [
                        2.3273895186253175,
                        48.88360751397975
                    ],
                    [
                        2.32742928183364,
                        48.8835218260109
                    ],
                    [
                        2.32729514794786,
                        48.883499830216635
                    ],
                    [
                        2.3271812663100526,
                        48.88348115420054
                    ],
                    [
                        2.327064220795119,
                        48.88345712096013
                    ],
                    [
                        2.3269240263378284,
                        48.8834283358019
                    ],
                    [
                        2.326716849425167,
                        48.883385795359146
                    ],
                    [
                        2.326706919926702,
                        48.883383752895966
                    ],
                    [
                        2.326583909029832,
                        48.88335844725428
                    ],
                    [
                        2.3265438297423473,
                        48.883350170097884
                    ],
                    [
                        2.325495712537428,
                        48.88313487209783
                    ],
                    [
                        2.3254561668640465,
                        48.88312669290914
                    ],
                    [
                        2.3254211359487664,
                        48.883119584169194
                    ],
                    [
                        2.3254206001159146,
                        48.88311947323023
                    ],
                    [
                        2.3253350038105114,
                        48.88310189101515
                    ],
                    [
                        2.3243298591698696,
                        48.88289528577199
                    ],
                    [
                        2.324329394046609,
                        48.88289519051581
                    ],
                    [
                        2.324227154486077,
                        48.882874214821655
                    ],
                    [
                        2.324215816143896,
                        48.88287188900203
                    ],
                    [
                        2.324185270927492,
                        48.88286558943418
                    ],
                    [
                        2.3241747730870235,
                        48.882863434731505
                    ],
                    [
                        2.324072520015966,
                        48.882842458827724
                    ],
                    [
                        2.3240721052038418,
                        48.88284237464656
                    ],
                    [
                        2.32403216054589,
                        48.882834186435005
                    ],
                    [
                        2.3239927478351046,
                        48.88282609384477
                    ],
                    [
                        2.323422276743954,
                        48.8827088522181
                    ],
                    [
                        2.3233823309622053,
                        48.88270066108319
                    ],
                    [
                        2.323350398348326,
                        48.88269410794157
                    ],
                    [
                        2.323347698763842,
                        48.88269355398396
                    ],
                    [
                        2.3232945184575304,
                        48.88268257833109
                    ],
                    [
                        2.323265202623694,
                        48.882675922144486
                    ],
                    [
                        2.3232647988274993,
                        48.882675829928765
                    ],
                    [
                        2.32054241152076,
                        48.882124230163434
                    ],
                    [
                        2.320523133598558,
                        48.882120518025175
                    ],
                    [
                        2.320452696402774,
                        48.88210695200276
                    ],
                    [
                        2.3203261240436643,
                        48.88208114300644
                    ],
                    [
                        2.320239358728123,
                        48.88206343266313
                    ],
                    [
                        2.3196292492905637,
                        48.881938891549844
                    ],
                    [
                        2.318910260952996,
                        48.88179214303144
                    ],
                    [
                        2.318835670964773,
                        48.88177691923343
                    ],
                    [
                        2.318781923827603,
                        48.881765949123306
                    ],
                    [
                        2.318749930691062,
                        48.881759418680204
                    ],
                    [
                        2.31788121353815,
                        48.88158210323387
                    ],
                    [
                        2.3168407552360146,
                        48.88136970418254
                    ],
                    [
                        2.3168288786150972,
                        48.881367298141434
                    ],
                    [
                        2.3166554356541718,
                        48.881331897054764
                    ],
                    [
                        2.3164993567178467,
                        48.88131613738746
                    ],
                    [
                        2.3125676714444467,
                        48.88083130159895
                    ],
                    [
                        2.311633468179984,
                        48.880716084423504
                    ],
                    [
                        2.309137784116886,
                        48.88041506603909
                    ],
                    [
                        2.3088389793358033,
                        48.88036273391453
                    ],
                    [
                        2.308611261224327,
                        48.88032285190501
                    ],
                    [
                        2.3055149589501087,
                        48.87966333547087
                    ],
                    [
                        2.3030919179104674,
                        48.87914080984653
                    ],
                    [
                        2.3009688243134603,
                        48.87868351661771
                    ],
                    [
                        2.2987382787474924,
                        48.87820431715699
                    ],
                    [
                        2.2987322150340512,
                        48.87820301626688
                    ],
                    [
                        2.2987303334085247,
                        48.878202610434776
                    ],
                    [
                        2.2985915783494764,
                        48.87817280015797
                    ],
                    [
                        2.2984644980855666,
                        48.87814549624281
                    ],
                    [
                        2.2981550403383206,
                        48.87807900911665
                    ],
                    [
                        2.298015504640969,
                        48.87788370260838
                    ],
                    [
                        2.2979756797508046,
                        48.87782795916052
                    ],
                    [
                        2.2960133783265797,
                        48.87512261856619
                    ],
                    [
                        2.295303084321323,
                        48.87414296157289
                    ],
                    [
                        2.295273534793913,
                        48.87410239634096
                    ],
                    [
                        2.2951669125644556,
                        48.873955232398906
                    ]
                ]
            ],
            "type": "Polygon"
        },
        "properties": {
            "n_sq_ar": 750000017,
            "c_ar": 17,
            "c_arinsee": 75117,
            "l_ar": "17Ã¨me Ardt",
            "l_aroff": "Batignolles-Monceau",
            "n_sq_co": 750001537,
            "surface": 5668834.50445393,
            "perimetre": 10775.579516,
            "geom_x_y": {
                "lon": 2.306776990574406,
                "lat": 48.88732652202577
            }
        }
    }
      const layer = L.geoJSON(obj as Feature, {
        style,
        onEachFeature
      });

      layer.addTo(layerGroup.current);
      return layer;
    } else
      throw new Error("Leaflet map is currently not being displayed");
  }

  // Clear layers contained within main LayerGroup
  const clearLayers = () => {
    if (layerGroup.current) {
      layerGroup.current.clearLayers();
    }
  }

  // Initializes Leaflet map and creates main LayerGroup
  useEffect(() => {
    if (mapElement.current) {
      map.current = initMap(mapElement.current);
      layerGroup.current = createLayer();
      map.current.addLayer(layerGroup.current);
    } else {
      removeMap();
      console.error("Error");
    }

    // Cleanup
    return () => {
      removeMap();
    };
  }, []);

  return (
    <div id="map" ref={mapElement}></div>
  );
});

export default LeafletMap;
